version: '3.1'
services:
    app:
        image: go_rest
        build:
            context: .
            dockerfile: Dockerfile
        environment:
           DATABASE_HOST: dbPostgres
        depends_on:
            - dbPostgres
        volumes:
            - .:/api
        ports:
            - '9000:9000'

    adminer:
        image:
            dockette/adminer:full
        container_name: "adminer"
        restart:
            always
        ports:
            - "8088:80"
    dbPostgres:
        image: postgres:12
        container_name: "postgres"
        restart: always
        ports:
            - "5432:5432"
        environment:
            POSTGRES_USER: postgres
            POSTGRES_PASSWORD: 1234
            POSTGRES_DB: apidb
        volumes:
            - postgres:/var/lib/postgresql/data
    redis:
        container_name: "redis"
        image: redis
        ports:
          - "6379:6379"
        volumes:
          - redis:/data
        entrypoint: redis-server --appendonly yes
        restart: always

volumes:
    postgres: {}
    redis: {}
